
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A human friendly data-oriented integration toolkit">
      
      
        <meta name="author" content="João Pinto">
      
      
        <link rel="canonical" href="https://www.openpipe.org/1.0/language/">
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../tool/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Language - Openpipe</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="green">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-pipeline-language" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Openpipe" class="md-header__button md-logo" aria-label="Openpipe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Openpipe
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Language
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Openpipe/openpipe/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    The Openpipe Tool
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Openpipe" class="md-nav__button md-logo" aria-label="Openpipe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Openpipe
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Openpipe/openpipe/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    The Openpipe Tool
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Language
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Language
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#segments" class="md-nav__link">
    Segments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    Actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-segments" class="md-nav__link">
    Multiple Segments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrated-development-environment" class="md-nav__link">
    Integrated Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-execution" class="md-nav__link">
    Workflow Execution
  </a>
  
    <nav class="md-nav" aria-label="Workflow Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#document-loading" class="md-nav__link">
    Document Loading
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action-modules" class="md-nav__link">
    Action Modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-items" class="md-nav__link">
    Data Items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    Data Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-configuration" class="md-nav__link">
    Dynamic Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tagging" class="md-nav__link">
    Data Tagging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#action-libraries" class="md-nav__link">
    Action Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copyright-and-license" class="md-nav__link">
    Copyright and License
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tool/" class="md-nav__link">
        Tool
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../action-devel/" class="md-nav__link">
        Actions Development
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
    <nav class="md-nav" aria-label="Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#segments" class="md-nav__link">
    Segments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actions" class="md-nav__link">
    Actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-segments" class="md-nav__link">
    Multiple Segments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integrated-development-environment" class="md-nav__link">
    Integrated Development Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#workflow-execution" class="md-nav__link">
    Workflow Execution
  </a>
  
    <nav class="md-nav" aria-label="Workflow Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#document-loading" class="md-nav__link">
    Document Loading
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action-modules" class="md-nav__link">
    Action Modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-items" class="md-nav__link">
    Data Items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    Data Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dynamic-configuration" class="md-nav__link">
    Dynamic Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tagging" class="md-nav__link">
    Data Tagging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#action-libraries" class="md-nav__link">
    Action Libraries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copyright-and-license" class="md-nav__link">
    Copyright and License
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="data-pipeline-language">Data Pipeline Language</h1>
<h2 id="introduction">Introduction</h2>
<hr />
<p>This page describes the syntax and core concepts of the <em>data pipeline language</em>, an human friendly data-oriented language that can be used to describe data transformation workflows for both structured and unstructured data. DPL does not replace technology specific languages (e.g. SQL), instead it  provides an higher level computable language capable of integrating data from diverse formats, sources and technology.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>DPL is entirely based on the <a href="http://yaml.org/spec/1.1/">YAML</a> format. The knowledge of YAML is fundamental for the proper understanding of the material in this document. While in general the data processing operations will be described using markup language, when calculations and transformations are needed, a good understanding of <a href="https://docs.python.org/3/library/stdtypes.html">Python's Standard Data Types and Operations</a> is required.</p>
<h2 id="concepts">Concepts</h2>
<h3 id="pipeline">Pipeline</h3>
<p>DPL follows the data pipeline design pattern: a set of data processing elements connected in series, where the output of one element is the input of the next one.
In DPL the elements are referred as <strong>actions</strong>, and a sequence of actions is referred as a <strong><em>segment</em></strong>. A pipeline document is a single YAML document that contains one or more segments.</p>
<h4 id="segments">Segments</h4>
<p>A segment must be represented by a dictionary, where the key is the segment name and the value is a sequence of actions.</p>
<div class="admonition warning">
<p class="admonition-title">_segment name </p>
<p>Segment names started with "_" will not be loaded. They can be used to store configuration to be referenced with YAML anchors. The <code>_libraries</code> segment name has a special purpose explained later on this document.</p>
</div>
<h4 id="actions">Actions</h4>
<p>An action must be represented by a dictionary, where the key is an action name and the value contains the action config, config may be of any of the YAML supported data types.</p>
<h4 id="example">Example</h4>
<blockquote>
<p>pipeline.yaml
    <div class="highlight"><pre><span></span><code><span class="c1"># This is the &#39;start&#39; segment</span>
<span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Call the &quot;print&quot; action with the config string Hello World!</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World!</span>
</code></pre></div></p>
<p>Output:
    <div class="highlight"><pre><span></span><code>Hello World!
</code></pre></div></p>
</blockquote>
<div class="admonition important">
<p class="admonition-title">The start segment</p>
<p>Runnable pipelines must contain a segment named <strong><em>start</em></strong> . The first operation in that segment will receive a single input item with openpipe run arguments.</p>
</div>
<h4 id="multiple-segments">Multiple Segments</h4>
<p>A single pipeline may need to produce distinct outputs from the same input data, in order to support this some actions can send data to other segments.</p>
<h3 id="integrated-development-environment">Integrated Development Environment</h3>
<p>At this time there is no specialized IDE for pipeline editing, any general purpose IDE with a good support for YAML is suitable.</p>
<h2 id="workflow-execution">Workflow Execution</h2>
<h3 id="document-loading">Document Loading</h3>
<p>The command line tool <code>openpipe</code> is the software that reads a pipeline document file, loads it into the execution engine and activates the workflow.</p>
<h3 id="action-modules">Action Modules</h3>
<p>The execution engine loads the action modules associated with  action names, and creates action instances for every action defined in the pipeline. Action modules can provide a wide range of action types: collection, filtering, exporting, etc.</p>
<p>You can get the list of available actions with:
<div class="highlight"><pre><span></span><code>openpipe<span class="w"> </span><span class="nb">help</span>
</code></pre></div></p>
<p>You can get the help for an action with:
<div class="highlight"><pre><span></span><code>openpipe help «action»
</code></pre></div></p>
<h3 id="data-items">Data Items</h3>
<p>In DPL any kind of workflow managed data is referred as an <em>item</em>, in openpipe <em>items</em> are stored in memory and transmitted as Python object references, as such, items can be of any data type or class available with Python.</p>
<h3 id="data-flow">Data Flow</h3>
<p>Action instances should be observed as independent processing units, the following items will be available to them:</p>
<ul>
<li>Input Item: the input data provided to the action</li>
<li>Config Item: the config data that is based on the user provided config</li>
<li>Output Item: output data produced by the action execution</li>
<li>Tag Item: the tag</li>
</ul>
<div class="admonition information">
<p class="admonition-title">Output -&gt; Input</p>
<p>As a general rule the output item of a action will be the input item of the next action in the same segment, with the exception of the <code>send to</code> action that can deliver items to the first action of other segments.</p>
</div>
<div class="admonition information">
<p class="admonition-title">Last Action Output Items</p>
<p>Output items from the last action in a segment will be silently discarded.</p>
</div>
<h3 id="dynamic-configuration">Dynamic Configuration</h3>
<p>Action configuration items provided in the pipeline document, can include dynamic components. When an action is executed due to the reception of an input item, it's configuration is updated to reflect any changes in the input. This feature provides the ability to embed python expressions and action input data on it's configuration.</p>
<p>Before invoking the action input handling, any config text found between consecutive dollar signs ($) will be evaluated as a python expression and replaced with it's result. If you need to have '$' in your string, you will need to escape it using \$ .</p>
<p>During expression evaluation, the "_" symbol is a reference to the full input item. When the input item is a dict, it's keys values will be mapped to variable names so that you can refer to them easily by providing $key$.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Several actions use a default configuration of <code>'{ _ }'</code> which means the full input item will be used as the configuration item. It is the case of the <code>print</code> and <code>assert</code> actions.</p>
</div>
<p>Examples:</p>
<blockquote>
<p>calc.yaml
    <div class="highlight"><pre><span></span><code><span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2 + 1 = $2 + 1$</span><span class="w">    </span><span class="c1"># Print a sum result</span>
</code></pre></div></p>
<p>Output:
    <div class="highlight"><pre><span></span><code>2 + 1 = 3
</code></pre></div></p>
<p>input_item.yaml
    <div class="highlight"><pre><span></span><code><span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span>
<span class="w">        </span><span class="nt">place</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zoo</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span><span class="w">    </span><span class="c1"># Print the full  input item</span>
</code></pre></div></p>
<p>input_field.yaml
    <div class="highlight"><pre><span></span><code><span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">insert</span><span class="p">:</span>
<span class="w">        </span><span class="nt">animal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Elephant</span>
<span class="w">        </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">big</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The $animal$ is $size$.</span><span class="w"> </span><span class="c1"># Print some fields</span>
</code></pre></div></p>
<p>Output:
    <div class="highlight"><pre><span></span><code>The Elephant is big.
</code></pre></div></p>
</blockquote>
<h3 id="data-tagging">Data Tagging</h3>
<p>One of the challenges of using independent pipeline actions with a strict input/output pattern is the need to correlate/aggregate outputs from different actions. Openpipe addresses this with the support for data tagging. Items flowing through a pipeline can be tagged, a tag is a piece of information that will be transmitted with every item as it is sent to the _after tagging actions in the pipeline.</p>
<p>Let's assume as example that we want to produce the count of 'a' letters from a list of files:
<div class="highlight"><pre><span></span><code><span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">iterate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/etc/passwd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">/etc/group</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">read from file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span>
<span class="w">    </span><span class="c1"># The read from file outputs only the file content, we can&#39;t refer to</span>
<span class="w">    </span><span class="c1"># the file name anymore</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The number of &#39;a&#39;s in file is $ _.count(b&#39;a&#39;) $</span>
</code></pre></div>
In order to persist the file name, we need to tag it before the the <em>read from file</em> action.  After being tagged, we can refer to it with the special reference <code>$_tag$</code> :
<div class="highlight"><pre><span></span><code><span class="nt">start</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">iterate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/etc/passwd</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">/etc/group</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span><span class="w"> </span><span class="c1"># The filename is tagged, tag is available on every next action</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">read from file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span>
<span class="w">    </span><span class="c1"># We can now use $_tag_</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">print</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The number of &#39;a&#39;s in file $_tag$ is $ _.count(b&#39;a&#39;) $</span>
</code></pre></div></p>
<p>When more than two items need to be tagged, a dictionary based tag needs to be used, every tag will be merged into the tag dict.</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># do some action</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> animal_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span><span class="w"> </span><span class="p p-Indicator">}</span><span class="w">   </span><span class="c1"># Tag it as animal type</span>
<span class="w">    </span><span class="c1"># do some other action</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> animal_size</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">_</span><span class="nv"> </span><span class="s">}&#39;</span><span class="w"> </span><span class="p p-Indicator">}</span><span class="w">   </span><span class="c1"># Tag it as animal size</span>
<span class="w">    </span><span class="c1"># We can now use $_tag[&#39;animal_type&#39;]$ and $_tag[&#39;animal_size&#39;]$</span>
</code></pre></div>
<h2 id="action-libraries">Action Libraries</h2>
<p>A pipeline may contain a special segment named <code>_libraries</code>. This segment must contain a list of local directories or urls for libraries containing additional actions.</p>
<h2 id="copyright-and-license">Copyright and License</h2>
<p>© 2019 CCS Group International</p>
<p>This document is distributed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      This site content is licensed under a <A HREF="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</A>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../js/autoexpand.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
      
        <script src="../../js/consentinit.js"></script>
      
    
  </body>
</html>